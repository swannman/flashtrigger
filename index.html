<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <title>Flash trigger</title>
        <link rel="stylesheet" href="../project.css" type="text/css">
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-26056542-1']);
            _gaq.push(['_trackPageview']);
            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </head>

    <body>
        <div class="container">
        <div class="main">
            <h1>Flash trigger</h1>
            <p>My first electronics project was a flash trigger for high-speed photography. This circuit is based on a similar design by <a href="http://users.abo.fi/johannes.eriksson/hispeed/howto.html">Johannes Eriksson</a>.</p>
            <p>Like Eriksson's, the heart of my flash trigger is a 555 timer and a flip-flop.  The timer lets us adjust the delay between the trigger and the flash — useful when we want a falling drop to fall a few more inches before we capture the photo.  The flip-flop triggers at the end of the delay and fires our flash.</p>
            <div class="photo center"><a href="https://github.com/swannman/flashtrigger/raw/gh-pages/schematic.pdf"><img src="https://github.com/swannman/flashtrigger/blob/gh-pages/schematic.png?raw=true" width="90%"/></a></div>
            <h3>Power supply</h3>
            <p>A MAX603 linear regulator provides a stable 5V power supply from a wide range of input voltages.</p>
            <h3>Trigger</h3>
            <p>The trigger circuit uses an infrared LED and a phototransistor to output a change in voltage when the light beam is interrupted.  Fairchild Semiconductor has a good <a href="http://www.fairchildsemi.com/an/AN/AN-3005.pdf">application note about phototransistors</a> — these useful devices allow current to flow only when light is present.  A large resistor between the phototransistor and ground causes 5V to be output when light is present and pulls the output to ground when the beam is interrupted.</p>
            <p>Unfortunately, ambient light will hit the phototransistor even when the LED beam is interrupted.  For example, the phototransistor may only reduce the voltage at its output by 1V when the beam is interrupted — it normally outputs 5V, and the 555 timer won't trigger until the voltage dips below 1.67V, so the change in voltage won't be noticed.</p>
            <p>To mitigate this, we divert some of the current from the output of the phototransistor to ground with a variable resistor — this subtracts voltage from the circuit's output. We adjust the variable resistor until the trigger circuit only outputs 2V.  When the beam is interrupted, the 1V drop in voltage will reduce the phototransistor output to 1V and trigger the 555.</p>
            <h3>Timer</h3>
            <p>The output from the trigger circuit is connected to the 555 timer's trigger input.  When the output from the trigger circuit goes low, the 555 puts 5V on pin 3 and begins to charge the .22uF capacitor on the left.  The resistor and capacitor on the left form an <a href="http://en.wikipedia.org/wiki/RC_circuit#Time_domain_considerations">RC circuit</a> — the lower the resistance of the variable resistor, the faster the capacitor charges.  When the capacitor is nearly full, the 555 drops pin 3 back to ground.</p>
            <p>Since the variable resistor controls how long the 555 timer's output stays high, we use it to control the delay between the light beam trigger and the flash.  In order to do so, we need a component which will wait for the 555 output to go from ground to 5V and back to ground again — and that's our flip-flop.
            <h3>Flip-flop</h3>
            <p>The flip-flop has two inputs (pins 3 and 14), two outputs (12 and 13), and a clock input (1).  Each time the clock input goes to 5V and then back to ground, the outputs change state.  The outputs are always opposites — if one is at 5V, the other is at ground.  The flip-flop is wired so that the outputs toggle back and forth each time the clock input is pulsed.</p>
            <p>Pin 2 of the flip-flop is a reset pin — when it is connected to ground, the chip resets its outputs so that pin 12 is at ground and pin 13 is at 5V.  The resistor and capacitor connected to the reset pin form an RC circuit, like the one connected to the 555 timer; when power is applied, the pin will start out at ground and slowly (depending on the capacitor and resistor values) rise to 5V as the capacitor charges. This resets the flip-flop to a known state when the circuit is powered on.</p>
            <p>With power on, the flip-flop is now waiting for a pulse to come in on pin 1.  It triggers on the <em>falling edge</em> of this pulse — not when it goes from ground to 5V, but when it falls from 5V back to ground.  (Recall that we wanted nothing to happen while the 555 timer's output was high, since that served as our delay.)  When this happens, the outputs will invert — pin 12 will go from ground to 2V, and pin 13 will go from 2V down to ground.</p>
            Each output is connected to the base of a transistor: an NPN transistor at pin 12, and a PNP transistor at pin 13.  An NPN transistor allows current to flow from its collector (top of the transistor symbol in this case) to its emitter (at the bottom) when voltage is present at its base.  Likewise, a PNP transistor allows current to flow when its base is at ground.  The transistors act like switches in our circuit — when pin 12 outputs 2V, its transistor will allow current to flow between its two pins, and likewise the transistor at pin 13 will conduct current when its base goes to ground.

            Let's run through the flip-flop's state one more time.  When it powers up, its outputs are set such that pin 12 is at ground and pin 13 is at 2V — so both transistors act like open switches.  At the end of a pulse from the 555, the output pins invert and both transistors turn on.

            The PNP transistor is connected to a <a href="http://www.irf.com/product-info/datasheets/data/pva33n.pdf#search=%22pva33n%22">PVA33N</a> solid-state relay.  This is a special type of switch which allows a large voltage (the flash, in this case) to be controlled by a much smaller voltage.  Internally it works much like our light trigger — pins 2 and 3 of the PVA33 are connected to an LED inside the case.  When current flows between these pins, the LED activates a phototransistor and short-circuits pins 5 and 6.

            Luckily for us, flash units fire when their pins are connected together.  A <a href="http://www.adorama.com/FAPCHSA.html">simple connector</a> from Adorama, connected to pins 5 and 6 of the PVA33, will allow the flash to fire when the PNP transistor below the relay turns on.

            Now that our flash has fired, we want to reset the circuit so that it can be triggered again.  Remember how we can reset the flip-flop by pulling pin 2 back to ground?  The NPN transistor at pin 12 creates yet another RC circuit when it turns on, discharging the 220uF capacitor just slowly enough to be sure that the flash fired.  When the capacitor has discharged, the flip-flop resets itself and both transistors turn off.

            <h3>Putting it all together</h3>
            Now that we've dealt with the details, let's look at the circuit at a high level.  The phototransistor in our light trigger is normally lit up by the LED, so it conducts 5V to the 555 timer's trigger input.  When the light beam is broken, it stops conducting current and the input voltage goes low.

            When the 555 sees a low voltage at its trigger input, it puts 5V on pin 3 and the .22uF capacitor begins to charge at a rate determined by the variable resistor above it.  When the capacitor is charged, the 555 brings pin 3 back to ground.

            When the flip-flop sees pin 1 go from low to high and back to low again, it reverses the state of pins 12 and 13 (from low to high, or from high to low).  This activates both transistors — one fires the flash by allowing current to flow through the PVA33 relay, while the other quickly bleeds current out of the capacitor connected to the flip-flop's reset pin.  When this capacitor has discharged, the flip-flop resets and the transistors turn off.
        </div>
    <div class="right">
        <div class="highlightbox">
            <a href="http://github.com/swannman/flashtrigger/">Browse project files</a><br/>
            <a href="http://github.com/swannman/flashtrigger/zipball/master">Download project files (.zip)</a><br/>
            <a href="mailto:swannman@mac.com?subject=Flash%20trigger">Email the author</a></br>
        </div>
        <div class="photo"><a href="http://swannman.smugmug.com/Archive/Matt-2006/DSC0134-2/450725075_5WjE5-XL.jpg"><img src="http://swannman.smugmug.com/Archive/Matt-2006/DSC0134-2/450725075_5WjE5-M.jpg" /></a></div>
        <div class="photo"><a href="http://swannman.smugmug.com/Archive/Matt-2006/DSC0135-2/450725120_scHWg-XL.jpg"><img src="http://swannman.smugmug.com/Archive/Matt-2006/DSC0135-2/450725120_scHWg-M.jpg" /></a></div>
        <div class="photo"><a href="http://swannman.smugmug.com/Archive/Matt-2006/DSC0112-2/450724109_WtjDv-XL.jpg"><img src="http://swannman.smugmug.com/Archive/Matt-2006/DSC0112-2/450724109_WtjDv-M.jpg" /></a></div>
        <div class="photo"><a href="http://swannman.smugmug.com/Archive/Matt-2006/DSC0183-Version-2/450727377_Q3LVP-XL.jpg"><img src="http://swannman.smugmug.com/Archive/Matt-2006/DSC0183-Version-2/450727377_Q3LVP-L.jpg" /></a></div>
        <div class="photo"><a href="http://swannman.smugmug.com/Archive/Matt-2006/DSC0192/450727803_YeTfD-XL.jpg"><img src="http://swannman.smugmug.com/Archive/Matt-2006/DSC0192/450727803_YeTfD-M.jpg" /></a></div> 
        <div class="photo"><a href="http://swannman.smugmug.com/Archive/Matt-2006/DSC0117-2/450724336_R7NfM-XL.jpg"><img src="http://swannman.smugmug.com/Archive/Matt-2006/DSC0117-2/450724336_R7NfM-M.jpg" /></a></div>
        <div class="photo"><a href="http://swannman.smugmug.com/Archive/Matt-2006/DSC0201-1/450728159_BWPTo-XL.jpg"><img src="http://swannman.smugmug.com/Archive/Matt-2006/DSC0201-1/450728159_BWPTo-M.jpg" /></a></div>
    </div>
    </div>
</body>
</html>
